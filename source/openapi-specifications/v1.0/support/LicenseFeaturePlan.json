{
	"openapi": "3.1.0",
	"info": {
		"title": "License",
		"version": "v1",
		"description": "API for managing and querying license information, features, and plan details.",
		"x-clan-group": "automation",
		"x-module-group": "users"
	},
	"tags": [
		{
			"name": "License",
			"description": "Operations related to license features and plan information."
		}
	],
	"paths": {
		"/api/v1/licenses/features": {
			"get": {
				"tags": [
					"License"
				],
				"summary": "Get License Feature Information",
				"description": "Fetches the list of all license features, with optional filters for active status and specific feature codes. Useful for retrieving their current availability (isAllowed) and usage limits. Returns either simple max values or detailed limit information based on the includeDetailedLimits parameter.",
				"operationId": "featureInfo",
				"parameters": [
					{
						"name": "featureCodes",
						"in": "query",
						"required": false,
						"description": "Comma-separated list of feature codes to retrieve information for.",
						"schema": {
							"type": "array",
							"items": {
								"type": "string"
							}
						},
						"style": "form",
						"explode": false
					},
					{
						"name": "isAllowed",
						"in": "query",
						"required": false,
						"description": "Filter features based on their active status.",
						"schema": {
							"type": "boolean"
						}
					},
					{
						"name": "includeDetailedLimits",
						"in": "query",
						"required": false,
						"description": "Flag to include detailed per-unit feature limits (max, free, add-on values) instead of only max values.",
						"schema": {
							"type": "boolean"
						}
					}
				],
				"responses": {
					"200": {
						"description": "Successfully retrieved feature information.",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/LicenseFeatureListResponse"
								},
								"examples": {
									"simple": {
										"summary": "Simple mode (includeDetailedLimits=false)",
										"value": {
											"data": [
												{
													"featureCode": "AGNT01",
													"featureName": "Agent",
													"isAllowed": true,
													"limits": [
														{
															"unitCode": "ORG",
															"maxValue": 33
														}
													]
												}
											]
										}
									},
									"detailed": {
										"summary": "Detailed mode (includeDetailedLimits=true)",
										"value": {
											"data": [
												{
													"featureCode": "AGNT01",
													"featureName": "Agent",
													"isAllowed": true,
													"limits": [
														{
															"unitCode": "ORG",
															"maxValue": 33,
															"freeValue": 5,
															"addOnValue": 3
														}
													]
												}
											]
										}
									}
								}
							}
						}
					},
					"422": {
						"$ref": "../common/Common.json#/components/responses/multipleUnprocessEntityResponse"
					}
				},
				"x-custom-url-attributes": {
					"apimethod": "com.zoho.desk.license.api.LicenseService.getFeaturesInfo"
				} ,
				"x-audience" : [ "external-public" ]
			}
		},
		"/api/v1/licenses/features/{featureCode}/availability": {
			"post": {
				"tags": [
					"License"
				],
				"summary": "Check License Availability",
				"description": "Checks if a specific license feature is available for the requested units and counts. Validates license limits against atomic and composite license units with their respective entity contexts.",
				"operationId": "checkLicenseAvailability",
				"parameters": [
					{
						"name": "featureCode",
						"in": "path",
						"required": true,
						"description": "The feature code to check availability for.",
						"schema": {
							"type": "string"
						}
					}
				],
				"requestBody": {
					"required": false,
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/LicenseAvailabilityRequest"
							},
							"examples": {
								"simple": {
									"summary": "Simple feature check",
									"value": {
										"requestCount": 1,
										"criteria": "update"
									}
								},
								"composite": {
									"summary": "Composite units check",
									"value": {
										"requestCount": 1,
										"units": [
											{
												"code": "ACTIVE/CNT/DEPT",
												"identifier": "active_count_dept",
												"requestCount": 1,
												"subUnits": [
													{
														"code": "CNT",
														"identifier": "count_unit",
														"entityId": 1000000000001
													},
													{
														"code": "DEPT",
														"identifier": "department_unit",
														"entityId": 1000000026432
													}
												]
											}
										]
									}
								}
							}
						}
					}
				},
				"responses": {
					"200": {
						"description": "Successfully checked license availability.",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/IsAllowedResponse"
								},
								"examples": {
									"isAllowed": {
										"value": {
											"isAllowed": true
										}
									},
									"notAllowed": {
										"value": {
											"isAllowed": false
										}
									}
								}
							}
						}
					},
					"422": {
						"$ref": "../common/Common.json#/components/responses/multipleUnprocessEntityResponse"
					}
				},
				"x-custom-url-attributes": {
					"apimethod": "com.zoho.desk.license.api.LicenseService.checkLicenseAvailable"
				}
			}
		},
		"/api/v1/licenses/plan": {
			"get": {
				"tags": [
					"License"
				],
				"summary": "Get License Plan Information",
				"description": "Retrieves details about the current license plan.",
				"operationId": "planinfo",
				"x-audience" : [ "external-public" ],
				"responses": {
					"200": {
						"description": "Successfully retrieved plan information.",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/PlanInfoResponse"
								},
								"examples": {
									"success": {
										"value": {
											"planName": "Enterprise",
											"planCode": "ENTP01",
											"planStatus": "Active",
											"expiryDate": "1749203963937",
											"billingCycle": "Annual",
											"storePlanId": 12345,
											"storeProfileId": "prof_abc123",
											"previousPlanCode": "PRO01"
										}
									}
								}
							}
						}
					},
					"422": {
						"$ref": "../common/Common.json#/components/responses/multipleUnprocessEntityResponse"
					}
				},
				"x-custom-url-attributes": {
					"apimethod": "com.zoho.desk.license.api.LicenseService.getPlanInfo"
				}
			}
		}
	},
	"components": {
		"schemas": {
			"LicenseAvailabilityRequest": {
				"type": "object",
				"description": "Request payload for checking license availability with atomic and composite units",
				"properties": {
					"criteria": {
						"type": "string",
						"description": "Additional filtering conditions to refine the license availability check",
						"example": "update"
					},
					"requestCount": {
						"type": "integer",
						"minimum": 0,
						"description": "Global request count applied when no unit-specific count is provided",
						"example": 1
					},
					"entityId": {
						"type": "integer",
						"format": "int64",
						"description": "Entity ID for context-based license checks",
						"example": 1000000026432
					},
					"units": {
						"type": "array",
						"description": "List of license units to validate. Can include both atomic and composite units",
						"items": {
							"$ref": "#/components/schemas/LicenseUnit"
						}
					}
				}
			},
			"LicenseUnit": {
				"type": "object",
				"description": "License unit definition for atomic or composite units",
				"properties": {
					"code": {
						"type": "string",
						"description": "Business code of the license unit (e.g., AGENT, MODULE) or composite code (e.g., AGENT/MODULE)",
						"example": "ACTIVE/CNT/DEPT"
					},
					"identifier": {
						"type": "string",
						"description": "Unique identifier for the license unit instance",
						"example": "active_count_dept"
					},
					"entityId": {
						"type": "integer",
						"format": "int64",
						"description": "Entity ID for the specific unit",
						"example": 1000000026432
					},
					"requestCount": {
						"type": "integer",
						"minimum": 0,
						"description": "Unit-specific request count",
						"example": 1
					},
					"subUnits": {
						"type": "array",
						"description": "Atomic sub-units that form this composite license bundle. Presence indicates composite unit",
						"items": {
							"$ref": "#/components/schemas/LicenseSubUnit"
						}
					}
				},
				"required": [
					"code"
				]
			},
			"LicenseSubUnit": {
				"type": "object",
				"description": "Atomic sub-unit within a composite license unit",
				"properties": {
					"code": {
						"type": "string",
						"description": "Business code of the license sub-unit (e.g., AGENT, MODULE, USER)",
						"example": "CNT"
					},
					"identifier": {
						"type": "string",
						"description": "Unique identifier for the license sub-unit instance",
						"example": "count_unit"
					},
					"entityId": {
						"type": "integer",
						"format": "int64",
						"description": "Entity ID for the specific sub-unit",
						"example": 1000000000001
					},
					"requestCount": {
						"type": "integer",
						"minimum": 0,
						"description": "Sub-unit-specific request count",
						"example": 1
					}
				},
				"required": [
					"code"
				]
			},
			"IsAllowedResponse": {
				"type": "object",
				"properties": {
					"isAllowed": {
						"type": "boolean",
						"description": "Indicates whether the requested license feature is available/allowed.",
						"example": true
					}
				},
				"required": [
					"isAllowed"
				],
				"additionalProperties": false
			},
			"LicenseUnitValue": {
				"type": "object",
				"description": "Detailed license unit value information",
				"properties": {
					"unitCode": {
						"type": "string",
						"description": "Type of unit for which the limit applies (e.g., ORG, AGENT, TEAM)",
						"example": "ORG"
					},
					"maxValue": {
						"type": "integer",
						"description": "Maximum allowed value for this unit",
						"example": 33
					},
					"freeValue": {
						"type": "integer",
						"description": "Free value included in the base plan",
						"example": 5
					},
					"addOnValue": {
						"type": "integer",
						"description": "Additional value from add-ons",
						"example": 3
					}
				},
				"required": [
					"unitCode",
					"maxValue"
				]
			},
			"SimpleLicenseUnit": {
				"type": "object",
				"description": "Simple license unit with only max value",
				"properties": {
					"unitCode": {
						"type": "string",
						"description": "Type of unit for which the limit applies (e.g., ORG, AGENT, TEAM)",
						"example": "ORG"
					},
					"maxValue": {
						"type": "integer",
						"description": "Maximum allowed value for this unit",
						"example": 33
					}
				},
				"required": [
					"unitCode",
					"maxValue"
				],
				"additionalProperties": false
			},
			"FeatureAllowed": {
				"type": "object",
				"description": "Details of an allowed feature with flexible limit information.",
				"properties": {
					"featureCode": {
						"type": "string",
						"description": "The unique code of the feature.",
						"example": "AGNT01"
					},
					"featureName": {
						"type": "string",
						"description": "The display name of the feature.",
						"example": "Agent"
					},
					"isAllowed": {
						"type": "boolean",
						"description": "Indicates if the feature is currently allowed under the license.",
						"example": true
					},
					"limits": {
						"type": "array",
						"description": "Array of license limits per applicable unit. Structure varies based on includeDetailedLimits parameter.",
						"items": {
							"anyOf": [
								{
									"$ref": "#/components/schemas/SimpleLicenseUnit"
								},
								{
									"$ref": "#/components/schemas/LicenseUnitValue"
								}
							]
						},
						"example": [
							{
								"unitCode": "ORG",
								"maxValue": 33,
								"freeValue": 5,
								"addOnValue": 3
							}
						]
					}
				},
				"required": [
					"featureCode",
					"featureName",
					"isAllowed"
				]
			},
			"LicenseFeatureListResponse": {
				"type": "object",
				"properties": {
					"data": {
						"type": "array",
						"items": {
							"$ref": "#/components/schemas/FeatureAllowed"
						}
					}
				}
			},
			"PlanInfoResponse": {
				"type": "object",
				"description": "Detailed information about the current license plan.",
				"properties": {
					"planName": {
						"type": "string",
						"description": "The name of the current plan.",
						"example": "Enterprise"
					},
					"planCode": {
						"type": "string",
						"description": "The unique code for the current plan.",
						"example": "ENTP01"
					},
					"planStatus": {
						"type": "string",
						"description": "The current status of the plan (e.g., Active, Trial, Expired).",
						"example": "Active"
					},
					"expiryDate": {
						"type": "integer",
						"format": "int64",
						"description": "The expiry date of the current plan represented as milliseconds since Unix epoch.",
						"example": 1749203963937
					},
					"billingCycle": {
						"type": "string",
						"description": "The billing cycle for the plan (e.g., Monthly, Annual).",
						"example": "Annual"
					},
					"storePlanId": {
						"type": "integer",
						"description": "The ID of the plan in the billing/store system.",
						"example": 12345
					},
					"storeProfileId": {
						"type": "string",
						"description": "The ID of the profile in the billing/store system.",
						"example": "prof_abc123"
					},
					"previousPlanCode": {
						"type": [
							"string",
							"null"
						],
						"description": "The code of the previous plan, if applicable.",
						"example": "PRO01"
					}
				}
			}
		},
		"securitySchemes": {
			"cookie-auth": {
				"$ref": "../common/Common.json#/components/securitySchemes/cookie-auth"
			},
			"org-oauth": {
				"$ref": "../common/Common.json#/components/securitySchemes/org-oauth"
			},
			"iam-oauth2-schema": {
				"$ref": "../common/Common.json#/components/securitySchemes/iam-oauth2-schema"
			}
		}
	},
	"x-entity": "License"
}
